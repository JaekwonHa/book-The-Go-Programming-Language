# ch2 프로그램 구조

#### 2.6.2 패키지 구조

패키지 수준 변수를 선언된 순서대로 초기화하며, 의존성이 있을때는 의존하는 변수부터 초기화한다.

패키지에 여러 .go 파일이 있으면 이름순으로 초기화된다.

이런 순서 제어를 위해서 init() 함수를 사용할 수 있다.

init() 함수는 호출하거나 참조할 수 없지만, 선언된 순서대로 자동으로 실행된다.


#### 2.7 범위

명시적 블록, 묵시적 블록

```go
    for i := 0; i < len(x); i++ {
        x := x[i]
    }
```

앞의 for loop 는 두개의 어휘 블록을 생성한다.

루프 본문에 대한 명시적 블록과 부가적으로 i와 같이 초기화 구문에 의해 선언된 변수를 둘러싸는 묵시적 블록이다.

```go
var cwd string
func init() {
    cwd, err := os.Getwd()
    if err != nil {
        log.Fatalf("os.Getwd failed: %v", err)
    }
}
```

앞의 코드에서 전역 cwd 변수는 초기화되지 않고 남아 있으며, 외관상으로는 정상적인 로그 출력이 버그를 모호하게 만들 것이다.

이를 해결하기 위한 여러가지 방법이 있는데, 직접적인 것은 err를 별도의 var 선언으로 분리하고 := 를 사용하지 않는 것이다.

